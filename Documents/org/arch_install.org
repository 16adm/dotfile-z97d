#+TITLE: arch安装备忘

* 准备
** 可引导U盘
*** 地址: https://mirrors.tuna.tsinghua.edu.cn/archlinux/iso/latest/
*** 地址: https://github.com/ventoy/Ventoy/releases
**sudo sh Ventoy2Disk.sh {-i | -I | -u} /dev/sdb
**cp *.iso /dev/sdb1
** 安装基本系统
*** 可引导盘启动后的准备
**** /etc/pacman.d/mirrorlist:
Server = https://mirrors.tuna.tsinghua.edu.cn/archlinux/$repo/os/$arch
Server = https://mirrors.163.com/archlinux/$repo/os/$arch
**** /etc/pacman.conf
...
IgnorePkg = expressvpn
...
[archlinuxcn]
Server = https://mirrors.tuna.tsinghua.edu.cn/archlinuxcn/$arch
**** 安装GIT: pacman -Sy git
**** GIT安装脚本:
***** git clone git://github.com/helmuthdu/aui
***** fifo
**** 用脚本中的FIFO安装基本系统:
***** keymap : us
***** editor : vi
***** mirrorlist : china
***** partition : gdisk [fn:1]
***** fstab : PARTUUID
***** hostname : Z97D
***** timezone : asia/shanghai
***** hardware clock : local
***** locale : en_US.UTF8
***** mkinitcpio : default
***** bootloader : sytemd-boot
****** /boot/loader/loader.conf
default zencjk 
timeout 1
console-mode max
editor no
auto-entries 0
auto-firmware 0
****** /boot/loader/entries/zencjk.conf
title Zen
linux /vmlinuz-linux-zencjk
initrd /intel-ucode.img
initrd /initramfs-linux-zencjk.img
options root=PARTUUID=xxxxxxxxxxxxxxxxxxxxxxxx rw quiet systemd.show_status=0
***** root passwd : ******
***** 不选择重启而推出aui
[fn:1]boot分区必须标识为EFI，否则无法安装，在gdisk里的命令为：t -> 1 -> EF00
**** CHROOT到已安装环境: arch-chroot /mnt
**** 安装对应CPU的UCODE: pacman -Sy intel-ucode
**** 重启进入新系统: reboot
** 后续系统完善
*** 基本配置
**** 添加用户:
***** useradd -m -g users -G wheel -s /bin/bash $username
***** chfn $username
***** passwd $username
***** visudo
***** 以user身份重新登录
**** DHCP网络:
***** /etc/systemd/network/20-wired.network
[Match]
Name=enp3s0
[Network]
DHCP=ipv4
***** /etc/systemd/network/25-wireless.network
[Match]
Name=wlp0s20u13
[Network]
DHCP=ipv4
***** sudo systemctl enable networkd
**** 安装yay:
***** pacman -S git yay 
**** 安装vim:
***** pacman -S neovim python-pynvim curl
***** curl -fLo ~/.vim/autoload/plug.vim --create-dirs \ https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim
***** 还原备份: .config/nvim/init.vim
***** in Nvim : PlugInstall
**** 安装emacs:
***** pacman -S emacs ripgrep fd shellcheck discount
***** git clone --depth 1 https://github.com/hlissner/doom-emacs ~/.emacs.d
***** 还原备份: .doom.d/{ packages.el ; init.el ; config.el }
***** doom sync
**** 安装其他console工具:
***** 还原备份: .bashrc ; .bash_profile
***** pacman -S tmux neofetch htop fzf unimatrix w3m
**** 用脚本中的LILO安装部分驱动:
***** 以root身份运行: ./lilo
***** 到安装显卡驱动时终止
***** reboot
*** X环境
**** Locale
***** en_US.UTF-8 ; zh_CN.UTF-8 ; ko_KR.UTF-8
**** WM
***** yay -S i3-gaps ranger rofi qutebrowser picom polybar alacritty feh
***** yay -S lxappearance-gtk3 lxrandr-gtk3 pcmanfm-gtk3
***** yay -S fcitx fcitx-rime fcitx-qt5 fcitx-hangul
***** yay -S interception-caps2esc expressvpn syncthing
***** yay -S mpv
***** yay -S zathura zathura-pdf-poppler
***** yay -S otf-nerd-fonts-fira-code noto-fonts-cjk otf-mplus adobe-source-han-sans-cn-fonts adobe-source-han-serif-cn-fonts
***** yay -S udskie udisks2 gvfs-mtp gvfs-gphoto2 [fn:2]
***** yay -S bluez rofi-bluetooth-git
***** 还原备份: ./config/{ i3 ; fontconfig ; picom ; rofi ; ranger ; polybar ; qutebrowser ; alacritty ; neofetch ; fcitx }
[fn:2]如果连接android设备或u盘有权限问题，则lsusb找到设备，chmod 666 $device
***** reboot
